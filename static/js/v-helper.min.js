!function(){Array.prototype.indexOf||(Array.prototype.indexOf=function(e,t){if(null==this)throw new TypeError("Array.prototype.indexOf() - can't convert `"+this+"` to object");var n=isFinite(t)?Math.floor(t):0,a=this instanceof Object?this:new Object(this),o=isFinite(a.length)?Math.floor(a.length):0;if(o<=n)return-1;if(n<0&&(n=Math.max(o+n,0)),void 0===e){do{if(n in a&&void 0===a[n])return n}while(++n<o)}else do{if(a[n]===e)return n}while(++n<o);return-1});var h=function(e,t){if(!e)return e;if("string"!=typeof e&&e instanceof Element)return n(e);var o;function n(e){if(e.isEle)return e;e.isEle=!0;var t={prototype:Element,val:function(e){return"string"==typeof e?this.value=e:this.value},html:function(e){return"string"==typeof e?this.innerHTML=e:this.innerHTML},next:function(){for(var e=this.nextSibling;e instanceof Text;)e=e.nextSibling;return h(e)},addClass:function(e){return classArray=this.className.split(" "),-1==classArray.indexOf(e)&&(this.className+=" "+e),this},removeClass:function(e){if(classArray=this.className.split(" "),-1!=classArray.indexOf(e))return classArray.splice(classArray.indexOf(e),1),this.className=classArray.join(" "),this},hasClass:function(e){return classArray=this.className.split(" "),-1<classArray.indexOf(e)},ele:function(e){return h(e,this)},getInput:function(e){return this.ele("input[name="+e+"]")[0]},addEvent:function(e,t){return this.addEventListener?this.addEventListener(e,t):this.attachEvent&&this.attachEvent("on"+e,function(e){(e=e||window.event).target=e.target||e.srcElement,t(e)}),this},target:function(e){if("string"==typeof e)if(document.dispatchEvent){var t=document.createEvent("HTMLEvents");t.initEvent(e,!0,!0),this.dispatchEvent(t)}else document.attachEvent&&this.fireEvent("on"+e);return this}};if(e.__proto__)t.__proto__=e.__proto__,e.__proto__=t;else for(var n in t)e[n]=t[n];return e}if(t=t||document,(o=2==e.split("#").length?document.getElementById(e.split("#")[1]):t.querySelectorAll(e))instanceof Element)o=n(o);else{if(!o)return console.log("unknow ele type ",e),null;for(var a=0;a<o.length;a++)n(o[a]);o.call=function(e,t,n){for(var a=0;a<o.length;a++)o[a][e](t,n)}}return o},e=function(e){this.modalTimer=null,this.vaptchaObj=null,this.form=h(document.body),this.options=e||{}};e.prototype={constructor:e,isPhone:function(e){return 5<e.trim().length},showMsg:function(e,t){var n=t?".vaptcha-tip-success":".vaptcha-tip-warn";this.modalTimer&&clearTimeout(this.modalTimer),box=this.form.ele(".vaptcha-tip-cont")[0],modal=this.form.ele(n)[0],modal.removeClass("none"),box.removeClass("none"),modal.ele(".dz-tip-text")[0].innerText=e,this.modalTimer=setTimeout(function(){box.addClass("none"),modal.addClass("none")},1500)},getFormData:function(e){for(var t=e.ele("input"),n={},a=0;a<t.length;a++)t[a].name&&(n[t[a].name]=t[a].value);return n},stopDefault:function(e){e&&e.preventDefault?(e.stopPropagation(),e.preventDefault()):(e.cancelBubble=!0,e.returnValue=!1)},ajax:function(e){var n,t=e.url,a=e.success,o=e.error,r=e.type||"GET",s=e.data||null;window.ActiveXObject?n=new ActiveXObject("Microsoft.XMLHTTP"):window.XMLHttpRequest&&(n=new XMLHttpRequest),n.open(r,this.options.site_url+t),"undefined"==typeof FormData&&n.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),n.send(function(e){if("object"!=typeof e)return e;if("function"==typeof FormData){var t=new FormData;for(var n in e)t.append(n,e[n]);return t}var a=new Array,o=0;for(var n in e)a[o]=encodeURIComponent(n)+"="+encodeURIComponent(e[n]),o++;return a.join("&")}(s)),n.onreadystatechange=function(e){if(4===n.readyState){var t=JSON.parse(n.responseText);200===n.status&&200===t.status?a&&a(t):o&&o(t)}}},initVaptcha:function(n){var a=this,o=n.form,r=n.success;n.scene=n.scene||"";var s=new function(){this.isPass=!1,this.vaptcha=null,this.refresh=function(){this.isPass&&(this.vaptcha.destroy(),a.initVaptcha(n))}},e=function(){a.ajax({url:"/plugin.php?id=phone_auth&action=getChallenge&scene="+n.scene+"&t="+(new Date).getTime(),success:function(e){var t={vid:(e=e.data).vid,challenge:e.challenge,container:n.element,type:n.type||"float",style:a.options.vaptcha_style||"dark",https:n.https||!1,color:a.options.vaptcha_color||"#3c8aff",lang:"zh-CN",outage:a.options.site_url+"/plugin.php?id=phone_auth&action=downtime",success:function(e,t){if(o){o.getElementsByTagName("input");o.querySelector("input[name=vaptcha_challenge]").value=t,o.querySelector("input[name=vaptcha_token]").value=e}s.isPass=!0,r&&r(e,t)}};window.vaptcha(t,function(e){if(o){o.getElementsByTagName("input");o.querySelector("input[name=vaptcha_challenge]").value="",o.querySelector("input[name=vaptcha_token]").value=""}s.vaptcha=e,s.vaptcha.init()})}})},t=document.getElementById("vaptcha_v_js");return t&&window.vaptcha&&t.loaded?e():(t=document.createElement("script"),protocol="https",t.src=protocol+"://cdn.vaptcha.com/v.js",t.id="vaptcha_v_js",t.onload=t.onreadystatechange=function(){this.readyState&&"loaded"!=this.readyState&&"complete"!=this.readyState||(e(),t.loaded=!0,t.onload=t.onreadystatechange=null)},document.getElementsByTagName("head")[0].appendChild(t)),s},resetSendCodeBtn:function(e){this.countDownTimer&&clearTimeout(this.countDownTimer),e.innerText=this.options.lang.send_code,e.removeAttribute("disabled")},buttonCountDown:function(t,n){var a=this;n=n||120,t.setAttribute("disabled","disabled"),this.countDownTimer&&clearTimeout(this.countDownTimer),function e(){if(0==n)return t.removeAttribute("disabled"),void(t.innerText=a.options.lang.send_code);t.innerText=n+"s",n--,a.countDownTimer=setTimeout(e,1e3)}()},passwordLevel:function(o,r){o.addEvent("keyup",function(e){e=e||window.event;var t=new RegExp("^(?=.{8,})(?=.*[A-Z])(?=.*[a-z])(?=.*[0-9])(?=.*\\W).*$","g"),n=new RegExp("^(?=.{7,})(((?=.*[A-Z])(?=.*[a-z]))|((?=.*[A-Z])(?=.*[0-9]))|((?=.*[a-z])(?=.*[0-9]))).*$","g"),a=(new RegExp("(?=.{6,}).*","g"),new RegExp("[a-zA-Z]"));6<=o.value.length?t.test(o.value)?(r.removeClass("pw-medium"),r.removeClass("pw-weak"),r.addClass("pw-strong"),canBeSubmit=!0):n.test(o.value)||a.test(o.value)?(r.removeClass("pw-strong"),r.removeClass("pw-weak"),r.addClass("pw-medium"),canBeSubmit=!0):(r.removeClass("pw-strong"),r.removeClass("pw-medium"),r.addClass("pw-weak"),canBeSubmit=!1):(0<o.value.length&&o.value.length<6?(r.removeClass("pw-strong"),r.removeClass("pw-medium"),r.addClass("pw-weak")):(r.removeClass("pw-strong"),r.removeClass("pw-medium"),r.removeClass("pw-weak")),canBeSubmit=!1),13==e.keyCode&&signUp()})},setTitle:function(e){var t=this.form.parentNode.id.split("_").pop(),n=h("#returnmessage_"+t);n&&0!=trim(n.html()).length&&n.html(e)},login_run:function(s){var l=this,e=h("form[name=login]")[0],u=h("#loginphone_"+s.id);this.form=u,e&&e.parentNode.removeChild(e);var o,i,r=!1,d=!1,c=!1,p=!1;function g(){var t=u.ele(".v-login-form")[0],e=t.ele(".vaptcha_container"),n=t.ele("input");if(l.setTitle(s.lang.login_member),!r){r=!0;var a=function(){var e=l.getFormData(t);0<e.user.length&&t.getInput("user").removeClass("error"),5<e.password.length&&t.getInput("password").removeClass("error"),0<e.user.length&&5<e.password.length?t.ele(".login-button")[0].removeAttribute("disabled"):t.ele(".login-button")[0].setAttribute("disabled","disabled")};s.login_captcha&&(o=l.initVaptcha({scene:"01",element:e,form:t,success:a})),n.call("addEvent","keyup",a),n.call("addEvent","blur",a),s.code_login&&t.ele(".sms-login-tab")[0].addEvent("click",function(e){t.addClass("none"),h(".v-sms-login-form")[0].removeClass("none"),function(){var t=u.ele(".v-sms-login-form")[0],e=t.ele(".vaptcha_container"),n=t.ele(".dz-btn-code")[0],a=t.ele("input"),o=t.ele(".login-button")[0];if(d)return;var r=function(){var e=l.getFormData(t);l.isPhone(e.phone)&&/^\d{6}$/.test(e.code)?o.removeAttribute("disabled"):o.setAttribute("disabled","disabled")};t.getInput("phone").addEvent("keyup",function(e){var t=e.target;!Number(t.value)&&(t.value=parseInt(t.value)?parseInt(t.value):""),l.resetSendCodeBtn(n)}),a.call("addEvent","focus",function(e){var t=e.target;t.removeClass("error")}),a.call("addEvent","keyup",r),a.call("addEvent","focus",r),d=!0;var s=l.initVaptcha({scene:"01",element:e,form:t,success:function(){n.click(),t.ele(".send-code-group")[0].removeClass("none")}}),i=!1;n.addEvent("click",function(){i||(l.isPhone(t.getInput("phone").value)?(i=!0,l.ajax({url:"/plugin.php?id=phone_auth&action=sendlogincode",type:"POST",data:{phone:t.getInput("phone").value,vaptcha_token:t.getInput("vaptcha_token").value,vaptcha_challenge:t.getInput("vaptcha_challenge").value},success:function(e){i=!1,l.showMsg(e.msg,!0),isSend=!0,n.setAttribute("disabled","disabled"),l.buttonCountDown(n,120)},error:function(e){i=!1,"vaptcha"===e.error_pos&&s.refresh(),"phone"===e.error_pos&&t.getInput("phone").addClass("error"),301===e.status?l.buttonCountDown(n,e.msg):l.showMsg(e.msg)}})):t.getInput("phone").addClass("error"))}),o.addEvent("click",function(e){l.ajax({url:"/plugin.php?id=phone_auth&mod=logging&action=smslogin&loginsubmit=yes",type:"POST",data:l.getFormData(t),success:function(e){window.location.reload()},error:function(e){0<=["user","password","vaptcha"].indexOf(e.error_pos)&&(t.getInput(e.error_pos)&&t.getInput(e.error_pos).addClass("error"),e.msg&&l.showMsg(e.msg)),e.msg&&l.showMsg(e.msg),t.ele(".login-button")[0].setAttribute("disabled","disabled")}})}),t.ele(".login-tab")[0].addEvent("click",function(e){t.addClass("none"),h(".v-login-form")[0].removeClass("none")})}()}),t.ele(".login-button")[0].addEvent("click",function(e){l.ajax({url:"/plugin.php?id=phone_auth&mod=logging&action=login&loginsubmit=yes",type:"POST",data:l.getFormData(t),success:function(e){window.location.reload()},error:function(e){if(0<=["user","password","vaptcha"].indexOf(e.error_pos)&&(t.getInput(e.error_pos)&&t.getInput(e.error_pos).addClass("error"),e.msg&&l.showMsg(e.msg)),"location_activation"===e.error_pos)return window.location.href=e.msg;e.msg&&l.showMsg(e.msg),s.login_captcha&&o.refresh(),t.ele(".login-button")[0].setAttribute("disabled","disabled")}})})}}function t(){var t=u.ele(".lost-password-form")[0],e=t.ele(".vaptcha_container"),n=t.ele("input"),a=t.ele(".dz-btn-code")[0];if(l.setTitle(s.lang.password_reset),c)return n.call("val",""),this.countDownTimer&&clearTimeout(this.countDownTimer),t.getInput("phone").removeAttribute("disabled"),t.ele("button").call("setAttribute","disabled","disabled"),a.removeAttribute("disabled"),a.html(s.lang.send_code),t.ele(".pw-strength")[0].className="pw-strength",void i.refresh();c=!0,i=l.initVaptcha({element:e,form:t,success:function(){o(),a.click(),t.ele(".send-code-group")[0].removeClass("none")}});var o=function(){l.isPhone(t.getInput("phone").value)&&t.getInput("phone").removeClass("error"),/^\d{6}$/.test(t.getInput("code").value)&&t.getInput("code").removeClass("error"),l.isPhone(t.getInput("phone").value)&&/^\d{6}$/.test(t.getInput("code").value)?t.ele(".next-step")[0].removeAttribute("disabled"):t.ele(".next-step")[0].setAttribute("disabled","disabled")};n.call("addEvent","keyup",o),t.ele(".next-step")[0].addEvent("click",function(){l.ajax({url:"/plugin.php?id=phone_auth&action=verifyCode",type:"POST",data:{phone:t.getInput("phone").value,code:t.getInput("code").value},success:function(e){t.addClass("none"),h(".reset-password")[0].removeClass("none"),function(){var e=u.ele(".reset-password")[0],t=e.ele("input");e.getInput("new_password");l.setTitle(s.lang.password_reset),p&&(t.call("val",""),e.ele("button").call("setAttribute","disabled","disabled"));p=!0,l.passwordLevel(e.getInput("new_password"),e.ele(".pw-strength")[0]),t.call("addEvent","keyup",function(){e.getInput("new_password").value.length==e.getInput("verify_password").value.length&&5<e.getInput("new_password").value.length&&e.getInput("new_password").value.length<21?e.ele(".submit-btn")[0].removeAttribute("disabled"):e.ele(".submit-btn")[0].setAttribute("disabled","disabled")}),e.ele(".submit-btn")[0].addEvent("click",function(){l.ajax({url:"/plugin.php?id=phone_auth&action=resetPassword",type:"POST",data:{new_password:e.getInput("new_password").value},success:function(e){l.showMsg(e.msg,!0),setTimeout(function(){u.ele(".vaptcha-dz-popup").call("addClass","none"),u.ele(".v-login-form")[0].removeClass("none"),g()},1e3)},error:function(e){l.showMsg(e.msg)}})})}()},error:function(e){t.ele(".next-step")[0].setAttribute("disabled","disabled"),"phone"==e.error_pos&&t.getInput("phone").addClass("error"),"code"==e.error_pos&&t.getInput("code").addClass("error"),l.showMsg(e.msg)}})}),t.getInput("phone").addEvent("keydown",function(){l.resetSendCodeBtn(a)});var r=!1;a.addEvent("click",function(){r||(o(),r=!0,l.ajax({url:"/plugin.php?id=phone_auth&action=sendcode",type:"POST",data:{phone:t.getInput("phone").value,vaptcha_token:t.getInput("vaptcha_token").value,vaptcha_challenge:t.getInput("vaptcha_challenge").value},success:function(e){r=!1,l.showMsg(e.msg,!0),!0,a.setAttribute("disabled","disabled"),l.buttonCountDown(a,120)},error:function(e){r=!1,"vaptcha"===e.error_pos&&i.refresh(),"phone"===e.error_pos&&t.getInput("phone").addClass("error"),301===e.status?l.buttonCountDown(a,e.msg):l.showMsg(e.msg)}}))})}var n=function(){u.ele(".vaptcha-dz-popup").call("addClass","none"),u.ele(".lost-password-form")[0].removeClass("none"),t()};h(".lost-password")[0]&&h(".lost-password")[0].addEvent("click",n),s.islostpwd?n():s.bind_phone?function(){var t=u.ele(".bind-phone-form")[0];u.ele(".vaptcha-dz-popup").call("addClass","none"),t.removeClass("none");var n=t.ele(".dz-btn-code")[0];l.setTitle(s.lang.bind_phone);var a=function(){l.isPhone(t.getInput("phone").value)?(t.getInput("phone").removeClass("error"),o.isPass&&6===t.getInput("code").value.length?t.ele(".bind-phone-btn")[0].removeAttribute("disabled"):t.ele(".bind-phone-btn")[0].setAttribute("disabled")):t.getInput("phone").addClass("error")};s.enable_inter&&(l.initCountryCode(t),t.getInput("country_code").addEvent("keyup",function(e){var t=e.target;!Number(t.value)&&(t.value=parseInt(t.value)?parseInt(t.value):"")}));var o=l.initVaptcha({element:t.ele(".vaptcha_container")[0],form:t,success:function(){n.target("click"),t.ele(".send-code-group")[0].removeClass("none")}});t.ele("input").call("addEvent","blur",a),t.ele("input").call("addEvent","focus",function(e){e.target.removeClass("error")}),t.getInput("code").addEvent("blur",function(e){e.target.target("keyup")}),t.getInput("code").addEvent("keyup",function(e){a(),it=e.target,6!==it.value.length?it.addClass("error"):it.removeClass("error")}),t.getInput("phone").addEvent("keydown",function(){l.resetSendCodeBtn(n)});var r=!1;n.addEvent("click",function(e){l.stopDefault(e),r||(r=!0,l.ajax({url:"/plugin.php?id=phone_auth&action=bindPhoneCode",type:"POST",data:l.getFormData(t),success:function(e){r=!1,l.showMsg(e.msg,!0),n.setAttribute("disabled","disabled"),l.buttonCountDown(n,120)},error:function(e){r=!1,"vaptcha"===e.error_pos&&o.refresh(),"phone"===e.error_pos&&t.getInput("phone").addClass("error"),301===e.status?l.buttonCountDown(n,e.msg):l.showMsg(e.msg)}}))}),t.ele(".bind-phone-btn")[0].addEvent("click",function(e){l.ajax({url:"/plugin.php?id=phone_auth&action=bindPhone",type:"POST",data:l.getFormData(t),success:function(e){200===e.status&&window.location.reload()},error:function(e){"phone"===e.error_pos&&t.getInput("phone").addClass("error"),o.refresh(),t.ele(".bind-phone-btn")[0].setAttribute("disabled","disabled"),l.showMsg(e.msg)}}),l.stopDefault(e)})}():g()},initCountryCode:function(n){var e=n.ele(".dropdown-menu")[0],t=n.ele(".btn-down")[0],a=function(){e.style.display="block",t.addClass("open")},o=function(){e.style.display="none",t.removeClass("open")};n.getInput("country_code").addEvent("focus",a),t.addEvent("click",function(){e.style.display="block"==e.style.display?o():a()}),h("body")[0].addEvent("click",function(e){var t=e.target;!n.ele(".dropdown")[0].contains(t)&&o()}),e.ele(".dropdown-item").call("addEvent","click",function(e){o(),n.getInput("country_code").value=e.target.innerHTML.split("+")[1].trim()})},register_run:function(n){var a=this,e=h("#registerform"),t=h("#registerphone_"+n.id);this.form=t;var o={username:!1,email:0==n.has_email,password:!1,phone:!1,vaptcha:!1,code:!1,qq:0==n.has_qq,agreebbrule:!0};e.html("");var r=h(".dz-btn-code")[0];function s(){var e=o.username&&o.email&&o.password&&o.phone;return e&&o.code&&o.agreebbrule?h("#register_btn").removeAttribute("disabled"):h("#register_btn").setAttribute("disabled","disabled"),e}if(n.enable_inter&&(this.initCountryCode(t),t.getInput("country_code").addEvent("keyup",function(e){var t=e.target;!Number(t.value)&&(t.value=parseInt(t.value)?parseInt(t.value):""),o.phone=a.isPhone(t.value)})),t.ele("input").call("addEvent","focus",function(e){var t=e.target;t.removeClass("error"),t.next()&&t.next().removeClass("error")}),t.getInput(n.username).addEvent("focus",function(e){e.target.next().html(n.lang.username)}),t.getInput(n.username).addEvent("keyup",function(e){var t=e.target;t.value=trim(t.value),o.username=!(t.value.length<3||15<t.value.length)}),t.getInput(n.username).addEvent("blur",function(e){var t=e.target;t.target("keyup"),o.username||(o.username=!1,t.addClass("error"),t.next().addClass("error"))}),1==n.has_email&&(t.getInput(n.email).addEvent("focus",function(e){e.target.next().html(n.lang.email)}),t.getInput(n.email).addEvent("keyup",function(e){var t=e.target;t.value=trim(t.value),o.email=/^(\w)+(\.\w+)*@(\w)+((\.\w{2,3}){1,3})$/.test(t.value)}),t.getInput(n.email).addEvent("blur",function(e){var t=e.target;t.target("keyup"),o.email||(t.addClass("error"),t.next().addClass("error"),t.next().html(n.lang.email_error))})),n.has_qq&&(t.getInput("qq").addEvent("focus",function(e){e.target.next().html("")}),t.getInput("qq").addEvent("keyup",function(e){var t=e.target;t.value=trim(t.value),t.value&&(o.qq=!0)}),t.getInput("qq").addEvent("blur",function(e){var t=e.target;t.target("keyup"),o.qq||(t.addClass("error"),t.next().addClass("error"),t.next().html(n.lang.qq_error))})),a.passwordLevel(t.getInput(n.password),t.ele(".pw-strength")[0]),t.getInput(n.password).addEvent("blur",function(e){var t=e.target;t.value.length<6||20<t.value.length?(o.password=!1,t.addClass("error"),t.next().addClass("error")):o.password=!0}),t.getInput("phone").addEvent("focus",function(e){e.target.next().html("")}),t.getInput("phone").addEvent("keyup",function(e){var t=e.target;!Number(t.value)&&(t.value=parseInt(t.value)?parseInt(t.value):""),o.phone=a.isPhone(t.value),a.resetSendCodeBtn(r)}),t.getInput("phone").addEvent("blur",function(e){var t=e.target;t.target("keyup"),o.phone||(t.addClass("error"),t.next().addClass("error"),t.next().html(n.lang.phone))}),t.getInput("code").addEvent("keyup",function(e){var t=e.target;t.value=trim(t.value),o.code=/^\d{6}$/.test(t.value)}),t.getInput("code").addEvent("blur",function(e){var t=e.target;t.target("keyup"),!o.code&&t.addClass("error")}),1===n.has_bbrules){t.ele(".protocal-link")[0].addEvent("click",function(){showDialog($("layer_bbrule").innerHTML,"info",""),$("fwin_dialog_close").style.display="none"});var i=function(){o.agreebbrule=h("#agreebbrule").checked,s()};h("#agreebbrule").addEvent("click",i),h("#agreebbrule").next().addEvent("click",i)}t.ele("input").call("addEvent","keyup",s);var l=!1;r.addEvent("click",function(){if(t.getInput("phone").target("blur"),!o.phone||l)return!1;l=!0,a.ajax({url:"/plugin.php?id=phone_auth&action=sendRegisterCode",type:"POST",data:{phone:t.getInput("phone").value,country_code:t.getInput("country_code").value.trim(),vaptcha_token:t.getInput("vaptcha_token").value,vaptcha_challenge:t.getInput("vaptcha_challenge").value},success:function(e){l=!1,r.setAttribute("disabled","disabled"),a.buttonCountDown(r,120)},error:function(e){l=!1,"vaptcha"===e.error_pos?(t.ele(".vaptcha_container")[0].next().html(e.msg),a.initVaptcha({element:t.ele(".vaptcha_container"),form:t,success:function(){s(),t.ele(".vaptcha_container")[0].next().html(""),r.target("click")}})):0<=["phone","code"].indexOf(e.error_pos)?(t.getInput(e.error_pos).addClass("error"),t.getInput(e.error_pos).next().addClass("error"),t.getInput(e.error_pos).next().html(e.msg)):301===e.status?a.buttonCountDown(r,e.msg):a.showMsg(e.msg)}})}),h("#register_btn").addEvent("click",function(){a.ajax({url:"/plugin.php?id=phone_auth&action=register",data:a.getFormData(t),type:"POST",success:function(e){200===e.status&&window.location.reload()},error:function(e){t.getInput(n.username),t.getInput(n.email);-1<["username","email","invitecode"].indexOf(e.error_pos)?(t.getInput(e.error_pos).addClass("error"),t.getInput(e.error_pos).next().addClass("error"),t.getInput(e.error_pos).next().html(e.msg)):e.msg&&a.showMsg(e.msg)}})}),a.initVaptcha({element:t.ele(".vaptcha_container"),form:t,success:function(){o.vaptcha=!0,t.ele(".dz-code-group")[0].removeClass("none"),t.ele(".vaptcha_container")[0].next().html(""),r.target("click"),s()}})},popup_captcha:function(e,t){var n=this;(t=t||h("#popup_vaptcha")).ele(".vp-header")[0].style.marginTop=((window.innerHeight||document.documentElement.clientHeight)-230)/2+"px",t.style.display="block",t.ele(".vp-mask")[0].addEvent("click",function(e){t.style.display="none"}),(void 0===t.is_pass||t.is_pass)&&(t.ele(".vp-content")[0].html('<div class="loading"><span style="animation-delay: -.32s"></span><span style="animation-delay: -.16s"></span><span></span></div>'),n.initVaptcha({scene:"01",element:t.ele(".vp-content"),type:"embed",form:e,success:function(){t.is_pass=!0,n.ajax({url:"/plugin.php?id=phone_auth&mod=logging&action=login&loginsubmit=yes",type:"POST",data:n.getFormData(e),success:function(e){window.location.reload()},error:function(e){return t.style.display="none","bind_phone"==e.error_pos?showWindow("login","member.php?mod=logging&action=login"):"location_activation"==e.error_pos?window.location.href=e.msg:void(e.msg&&errorhandle_ls(e.msg,{loginperm:"4"}))}})}}),t.is_pass=!1)},login_simple_run:function(a){var o=this,e=h("#lsform").ele(".fastlg")[0],t=e.ele(".pns")[0],r=e.ele(".v-login-simple")[0];e.replaceChild(r,t),r.ele(".login-btn")[0].addEvent("click",function(e){o.stopDefault(e);var t=r.getInput("user"),n=r.getInput("password");t.val()&&n.val()?a.login_captcha?o.popup_captcha(r):o.ajax({url:"/plugin.php?id=phone_auth&mod=logging&action=login&loginsubmit=yes",type:"POST",data:o.getFormData(r),success:function(e){window.location.reload()},error:function(e){if(console.log(e),"bind_phone"==e.error_pos)return showWindow("login","member.php?mod=logging&action=login");e.msg&&errorhandle_ls(e.msg,{loginperm:"4"})}}):showWindow("login","member.php?mod=logging&action=login")})},activation:function(){var t=h("#registerform"),e=t.ele("#registerformsubmit"),n=this;console.log(n.getFormData(t)),e.addEvent("click",function(e){e.preventDefault(),n.ajax({type:"POST",url:"/plugin.php?id=phone_auth&action=activation",data:n.getFormData(t),success:function(){window.location.reload()},error:function(e){errorhandle_ls(e.msg,"")}})})}},window.v_helper=e,window.ele=h}();